/Users/linseypang/miniconda3/envs/sas/lib/python3.10/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
22:18:47 - Epoch 001: Train Loss = 0.7174
22:18:54 - Epoch 001: Val Loss = 0.6824 HR = 0.3176, NDCG = 0.1646
22:19:51 - Epoch 002: Train Loss = 0.6222
22:19:58 - Epoch 002: Val Loss = 0.6689 HR = 0.3632, NDCG = 0.1893
22:20:57 - Epoch 003: Train Loss = 0.5999
22:21:04 - Epoch 003: Val Loss = 0.6527 HR = 0.3795, NDCG = 0.2056
22:22:03 - Epoch 004: Train Loss = 0.5886
22:22:11 - Epoch 004: Val Loss = 0.6030 HR = 0.3907, NDCG = 0.2154
22:23:10 - Epoch 005: Train Loss = 0.5819
22:23:17 - Epoch 005: Val Loss = 0.6301 HR = 0.4081, NDCG = 0.2259
22:24:16 - Epoch 006: Train Loss = 0.5796
22:24:24 - Epoch 006: Val Loss = 0.6220 HR = 0.4046, NDCG = 0.2267
22:25:24 - Epoch 007: Train Loss = 0.5767
22:25:32 - Epoch 007: Val Loss = 0.6034 HR = 0.4097, NDCG = 0.2306
22:26:32 - Epoch 008: Train Loss = 0.5746
22:26:40 - Epoch 008: Val Loss = 0.6110 HR = 0.4068, NDCG = 0.2274
22:27:41 - Epoch 009: Train Loss = 0.5720
22:27:49 - Epoch 009: Val Loss = 0.5872 HR = 0.4122, NDCG = 0.2318
22:28:49 - Epoch 010: Train Loss = 0.5703
22:28:57 - Epoch 010: Val Loss = 0.5854 HR = 0.4152, NDCG = 0.2322
22:29:58 - Epoch 011: Train Loss = 0.5689
22:30:06 - Epoch 011: Val Loss = 0.5792 HR = 0.4170, NDCG = 0.2351
22:31:06 - Epoch 012: Train Loss = 0.5673
22:31:14 - Epoch 012: Val Loss = 0.5939 HR = 0.4183, NDCG = 0.2341
22:32:15 - Epoch 013: Train Loss = 0.5668
22:32:23 - Epoch 013: Val Loss = 0.5988 HR = 0.4244, NDCG = 0.2405
22:33:26 - Epoch 014: Train Loss = 0.5650
22:33:34 - Epoch 014: Val Loss = 0.6133 HR = 0.4175, NDCG = 0.2352
22:34:36 - Epoch 015: Train Loss = 0.5648
22:34:44 - Epoch 015: Val Loss = 0.5823 HR = 0.4269, NDCG = 0.2403
22:35:46 - Epoch 016: Train Loss = 0.5631
22:35:54 - Epoch 016: Val Loss = 0.6032 HR = 0.4250, NDCG = 0.2429
22:36:57 - Epoch 017: Train Loss = 0.5625
22:37:05 - Epoch 017: Val Loss = 0.6133 HR = 0.4266, NDCG = 0.2435
22:38:07 - Epoch 018: Train Loss = 0.5621
22:38:15 - Epoch 018: Val Loss = 0.5884 HR = 0.4331, NDCG = 0.2480
22:39:18 - Epoch 019: Train Loss = 0.5610
22:39:26 - Epoch 019: Val Loss = 0.5888 HR = 0.4273, NDCG = 0.2424
22:40:26 - Epoch 020: Train Loss = 0.5605
22:40:34 - Epoch 020: Val Loss = 0.5967 HR = 0.4328, NDCG = 0.2483
22:41:32 - Epoch 021: Train Loss = 0.5609
22:41:39 - Epoch 021: Val Loss = 0.5861 HR = 0.4318, NDCG = 0.2478
22:42:38 - Epoch 022: Train Loss = 0.5599
22:42:45 - Epoch 022: Val Loss = 0.5890 HR = 0.4337, NDCG = 0.2484
22:43:44 - Epoch 023: Train Loss = 0.5592
22:43:51 - Epoch 023: Val Loss = 0.5867 HR = 0.4312, NDCG = 0.2482
22:44:50 - Epoch 024: Train Loss = 0.5575
22:44:57 - Epoch 024: Val Loss = 0.5864 HR = 0.4324, NDCG = 0.2475
22:45:56 - Epoch 025: Train Loss = 0.5577
22:46:03 - Epoch 025: Val Loss = 0.5739 HR = 0.4313, NDCG = 0.2509
22:47:02 - Epoch 026: Train Loss = 0.5583
22:47:09 - Epoch 026: Val Loss = 0.5612 HR = 0.4358, NDCG = 0.2514
22:48:08 - Epoch 027: Train Loss = 0.5574
22:48:16 - Epoch 027: Val Loss = 0.5697 HR = 0.4288, NDCG = 0.2452
22:49:15 - Epoch 028: Train Loss = 0.5581
22:49:22 - Epoch 028: Val Loss = 0.5563 HR = 0.4350, NDCG = 0.2533
22:50:21 - Epoch 029: Train Loss = 0.5569
22:50:28 - Epoch 029: Val Loss = 0.5678 HR = 0.4340, NDCG = 0.2528
22:51:27 - Epoch 030: Train Loss = 0.5563
22:51:34 - Epoch 030: Val Loss = 0.5616 HR = 0.4401, NDCG = 0.2570
22:52:33 - Epoch 031: Train Loss = 0.5563
22:52:41 - Epoch 031: Val Loss = 0.5543 HR = 0.4339, NDCG = 0.2533
22:53:40 - Epoch 032: Train Loss = 0.5556
22:53:47 - Epoch 032: Val Loss = 0.5468 HR = 0.4379, NDCG = 0.2525
22:54:46 - Epoch 033: Train Loss = 0.5549
22:54:53 - Epoch 033: Val Loss = 0.5646 HR = 0.4368, NDCG = 0.2525
22:55:52 - Epoch 034: Train Loss = 0.5541
22:55:59 - Epoch 034: Val Loss = 0.5788 HR = 0.4388, NDCG = 0.2526
22:56:59 - Epoch 035: Train Loss = 0.5549
22:57:06 - Epoch 035: Val Loss = 0.5707 HR = 0.4342, NDCG = 0.2534
22:58:05 - Epoch 036: Train Loss = 0.5556
22:58:12 - Epoch 036: Val Loss = 0.5846 HR = 0.4293, NDCG = 0.2498
22:59:11 - Epoch 037: Train Loss = 0.5544
22:59:19 - Epoch 037: Val Loss = 0.5572 HR = 0.4392, NDCG = 0.2550
23:00:18 - Epoch 038: Train Loss = 0.5547
23:00:25 - Epoch 038: Val Loss = 0.5501 HR = 0.4386, NDCG = 0.2551
23:01:24 - Epoch 039: Train Loss = 0.5534
23:01:31 - Epoch 039: Val Loss = 0.5776 HR = 0.4431, NDCG = 0.2571
23:02:30 - Epoch 040: Train Loss = 0.5531
23:02:37 - Epoch 040: Val Loss = 0.5562 HR = 0.4360, NDCG = 0.2551
23:03:37 - Epoch 041: Train Loss = 0.5528
23:03:44 - Epoch 041: Val Loss = 0.5577 HR = 0.4447, NDCG = 0.2583
23:04:43 - Epoch 042: Train Loss = 0.5535
23:04:50 - Epoch 042: Val Loss = 0.5567 HR = 0.4449, NDCG = 0.2616
23:05:50 - Epoch 043: Train Loss = 0.5538
23:05:57 - Epoch 043: Val Loss = 0.5607 HR = 0.4438, NDCG = 0.2595
23:06:56 - Epoch 044: Train Loss = 0.5528
23:07:03 - Epoch 044: Val Loss = 0.5427 HR = 0.4457, NDCG = 0.2596
23:08:03 - Epoch 045: Train Loss = 0.5521
23:08:10 - Epoch 045: Val Loss = 0.5399 HR = 0.4412, NDCG = 0.2593
23:09:09 - Epoch 046: Train Loss = 0.5520
23:09:16 - Epoch 046: Val Loss = 0.5574 HR = 0.4426, NDCG = 0.2593
23:10:15 - Epoch 047: Train Loss = 0.5522
23:10:23 - Epoch 047: Val Loss = 0.5412 HR = 0.4425, NDCG = 0.2586
23:11:22 - Epoch 048: Train Loss = 0.5529
23:11:29 - Epoch 048: Val Loss = 0.5487 HR = 0.4461, NDCG = 0.2633
23:12:29 - Epoch 049: Train Loss = 0.5517
23:12:36 - Epoch 049: Val Loss = 0.5243 HR = 0.4432, NDCG = 0.2591
23:13:35 - Epoch 050: Train Loss = 0.5510
23:13:42 - Epoch 050: Val Loss = 0.5560 HR = 0.4427, NDCG = 0.2580
23:14:41 - Epoch 051: Train Loss = 0.5509
23:14:49 - Epoch 051: Val Loss = 0.5433 HR = 0.4477, NDCG = 0.2572
23:15:47 - Epoch 052: Train Loss = 0.5523
23:15:55 - Epoch 052: Val Loss = 0.5553 HR = 0.4466, NDCG = 0.2587
23:16:54 - Epoch 053: Train Loss = 0.5509
23:17:01 - Epoch 053: Val Loss = 0.5612 HR = 0.4425, NDCG = 0.2562
23:18:00 - Epoch 054: Train Loss = 0.5517
23:18:07 - Epoch 054: Val Loss = 0.5603 HR = 0.4417, NDCG = 0.2588
23:19:06 - Epoch 055: Train Loss = 0.5506
23:19:14 - Epoch 055: Val Loss = 0.5480 HR = 0.4454, NDCG = 0.2611
23:20:13 - Epoch 056: Train Loss = 0.5510
23:20:20 - Epoch 056: Val Loss = 0.5382 HR = 0.4484, NDCG = 0.2618
23:21:19 - Epoch 057: Train Loss = 0.5511
23:21:27 - Epoch 057: Val Loss = 0.5495 HR = 0.4413, NDCG = 0.2579
23:22:26 - Epoch 058: Train Loss = 0.5507
23:22:33 - Epoch 058: Val Loss = 0.5638 HR = 0.4467, NDCG = 0.2617
23:23:33 - Epoch 059: Train Loss = 0.5504
23:23:40 - Epoch 059: Val Loss = 0.5598 HR = 0.4466, NDCG = 0.2608
23:24:39 - Epoch 060: Train Loss = 0.5501
23:24:47 - Epoch 060: Val Loss = 0.5251 HR = 0.4479, NDCG = 0.2619
23:25:46 - Epoch 061: Train Loss = 0.5502
23:25:54 - Epoch 061: Val Loss = 0.5606 HR = 0.4466, NDCG = 0.2611
23:26:53 - Epoch 062: Train Loss = 0.5503
23:27:00 - Epoch 062: Val Loss = 0.5738 HR = 0.4498, NDCG = 0.2625
23:28:00 - Epoch 063: Train Loss = 0.5504
23:28:07 - Epoch 063: Val Loss = 0.5697 HR = 0.4458, NDCG = 0.2619
23:29:06 - Epoch 064: Train Loss = 0.5488
23:29:13 - Epoch 064: Val Loss = 0.5384 HR = 0.4460, NDCG = 0.2620
23:30:13 - Epoch 065: Train Loss = 0.5491
23:30:20 - Epoch 065: Val Loss = 0.5859 HR = 0.4481, NDCG = 0.2626
23:31:19 - Epoch 066: Train Loss = 0.5489
23:31:27 - Epoch 066: Val Loss = 0.5355 HR = 0.4483, NDCG = 0.2644
23:32:26 - Epoch 067: Train Loss = 0.5489
23:32:34 - Epoch 067: Val Loss = 0.5619 HR = 0.4452, NDCG = 0.2589
23:33:33 - Epoch 068: Train Loss = 0.5484
23:33:40 - Epoch 068: Val Loss = 0.5447 HR = 0.4505, NDCG = 0.2636
23:34:40 - Epoch 069: Train Loss = 0.5488
23:34:47 - Epoch 069: Val Loss = 0.5316 HR = 0.4507, NDCG = 0.2635
23:35:46 - Epoch 070: Train Loss = 0.5491
23:35:53 - Epoch 070: Val Loss = 0.5276 HR = 0.4534, NDCG = 0.2663
23:36:53 - Epoch 071: Train Loss = 0.5488
23:37:00 - Epoch 071: Val Loss = 0.5316 HR = 0.4471, NDCG = 0.2616
23:37:59 - Epoch 072: Train Loss = 0.5477
23:38:07 - Epoch 072: Val Loss = 0.5593 HR = 0.4528, NDCG = 0.2663
23:39:06 - Epoch 073: Train Loss = 0.5486
23:39:13 - Epoch 073: Val Loss = 0.5322 HR = 0.4488, NDCG = 0.2664
23:40:12 - Epoch 074: Train Loss = 0.5484
23:40:20 - Epoch 074: Val Loss = 0.5305 HR = 0.4487, NDCG = 0.2667
23:41:19 - Epoch 075: Train Loss = 0.5486
23:41:26 - Epoch 075: Val Loss = 0.5439 HR = 0.4542, NDCG = 0.2654
23:42:25 - Epoch 076: Train Loss = 0.5484
23:42:33 - Epoch 076: Val Loss = 0.5284 HR = 0.4482, NDCG = 0.2659
23:43:32 - Epoch 077: Train Loss = 0.5493
23:43:39 - Epoch 077: Val Loss = 0.5516 HR = 0.4513, NDCG = 0.2668
23:44:39 - Epoch 078: Train Loss = 0.5474
23:44:46 - Epoch 078: Val Loss = 0.5431 HR = 0.4486, NDCG = 0.2616
23:45:45 - Epoch 079: Train Loss = 0.5473
23:45:53 - Epoch 079: Val Loss = 0.5507 HR = 0.4522, NDCG = 0.2669
23:46:52 - Epoch 080: Train Loss = 0.5470
23:46:59 - Epoch 080: Val Loss = 0.5571 HR = 0.4465, NDCG = 0.2627
23:47:58 - Epoch 081: Train Loss = 0.5475
23:48:05 - Epoch 081: Val Loss = 0.5465 HR = 0.4489, NDCG = 0.2663
23:49:04 - Epoch 082: Train Loss = 0.5469
23:49:12 - Epoch 082: Val Loss = 0.5555 HR = 0.4499, NDCG = 0.2645
23:50:17 - Epoch 083: Train Loss = 0.5479
23:50:25 - Epoch 083: Val Loss = 0.5615 HR = 0.4512, NDCG = 0.2653
23:51:31 - Epoch 084: Train Loss = 0.5478
23:51:39 - Epoch 084: Val Loss = 0.5413 HR = 0.4483, NDCG = 0.2633
23:52:48 - Epoch 085: Train Loss = 0.5469
23:52:56 - Epoch 085: Val Loss = 0.5590 HR = 0.4485, NDCG = 0.2636
23:54:02 - Epoch 086: Train Loss = 0.5473
23:54:10 - Epoch 086: Val Loss = 0.5347 HR = 0.4522, NDCG = 0.2654
23:55:18 - Epoch 087: Train Loss = 0.5472
23:55:26 - Epoch 087: Val Loss = 0.5393 HR = 0.4559, NDCG = 0.2708
23:56:33 - Epoch 088: Train Loss = 0.5485
23:56:40 - Epoch 088: Val Loss = 0.5338 HR = 0.4526, NDCG = 0.2652
23:57:48 - Epoch 089: Train Loss = 0.5462
23:57:56 - Epoch 089: Val Loss = 0.5698 HR = 0.4504, NDCG = 0.2655
23:59:02 - Epoch 090: Train Loss = 0.5475
23:59:09 - Epoch 090: Val Loss = 0.5390 HR = 0.4527, NDCG = 0.2655
00:00:09 - Epoch 091: Train Loss = 0.5469
00:00:16 - Epoch 091: Val Loss = 0.5351 HR = 0.4539, NDCG = 0.2673
00:01:15 - Epoch 092: Train Loss = 0.5470
00:01:22 - Epoch 092: Val Loss = 0.5493 HR = 0.4581, NDCG = 0.2687
00:02:22 - Epoch 093: Train Loss = 0.5464
00:02:29 - Epoch 093: Val Loss = 0.5443 HR = 0.4541, NDCG = 0.2670
00:03:29 - Epoch 094: Train Loss = 0.5464
00:03:36 - Epoch 094: Val Loss = 0.5223 HR = 0.4570, NDCG = 0.2697
00:04:36 - Epoch 095: Train Loss = 0.5470
00:04:44 - Epoch 095: Val Loss = 0.5411 HR = 0.4537, NDCG = 0.2651
00:05:44 - Epoch 096: Train Loss = 0.5483
00:05:52 - Epoch 096: Val Loss = 0.5376 HR = 0.4570, NDCG = 0.2708
00:06:52 - Epoch 097: Train Loss = 0.5469
00:06:59 - Epoch 097: Val Loss = 0.5472 HR = 0.4574, NDCG = 0.2699
00:08:08 - Epoch 098: Train Loss = 0.5467
00:08:15 - Epoch 098: Val Loss = 0.5275 HR = 0.4531, NDCG = 0.2655
00:09:25 - Epoch 099: Train Loss = 0.5475
00:09:33 - Epoch 099: Val Loss = 0.5238 HR = 0.4522, NDCG = 0.2692
00:10:41 - Epoch 100: Train Loss = 0.5460
00:10:48 - Epoch 100: Val Loss = 0.5449 HR = 0.4513, NDCG = 0.2649
00:11:57 - Epoch 101: Train Loss = 0.5465
00:12:05 - Epoch 101: Val Loss = 0.5424 HR = 0.4524, NDCG = 0.2683
00:13:13 - Epoch 102: Train Loss = 0.5467
00:13:21 - Epoch 102: Val Loss = 0.5483 HR = 0.4520, NDCG = 0.2662
00:14:30 - Epoch 103: Train Loss = 0.5462
00:14:38 - Epoch 103: Val Loss = 0.5389 HR = 0.4558, NDCG = 0.2661
00:15:46 - Epoch 104: Train Loss = 0.5453
00:15:54 - Epoch 104: Val Loss = 0.5136 HR = 0.4528, NDCG = 0.2704
00:17:02 - Epoch 105: Train Loss = 0.5450
00:17:10 - Epoch 105: Val Loss = 0.5398 HR = 0.4544, NDCG = 0.2672
00:18:18 - Epoch 106: Train Loss = 0.5455
00:18:26 - Epoch 106: Val Loss = 0.5284 HR = 0.4515, NDCG = 0.2680
00:19:34 - Epoch 107: Train Loss = 0.5462
00:19:42 - Epoch 107: Val Loss = 0.5383 HR = 0.4511, NDCG = 0.2669
No improvement in 20 epochs, early stopping...
Traceback (most recent call last):
  File "/Users/linseypang/work/carca-replication/scripts/training.py", line 176, in <module>
    model = train(
  File "/Users/linseypang/work/carca-replication/scripts/../src/train.py", line 142, in train
    model = torch.load(path)
  File "/Users/linseypang/miniconda3/envs/sas/lib/python3.10/site-packages/torch/serialization.py", line 1524, in load
    raise pickle.UnpicklingError(_get_wo_message(str(e))) from None
_pickle.UnpicklingError: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL src.carca.CARCA was not an allowed global by default. Please use `torch.serialization.add_safe_globals([src.carca.CARCA])` or the `torch.serialization.safe_globals([src.carca.CARCA])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
